---
title: "Salinity stress in Eruca sativa (E. sativa)"
author: "Anastasiia Revva, Juan Felipe Villamil Lozano, Aliona Hoste"
date: "17/11/2020"
output:
  html_document:
    code_folding: hide
    theme: paper
    highlight: zenburn
    toc: true
    toc_depth: 4
---
<style>
body {
text-align: justify;
padding: 2em;}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages and libraries required, message=FALSE}
#install.packages("biogeo")
#install.packages("corrplot")
#install.packages("dendextend")
#install.packages("docxtractr")
#install.packages("dplyr")
#install.packages("factoextra")
#install.packages("Formula")
#install.packages("ggfortify")
#install.packages("ggplot2", dependencies = TRUE)
#install.packages("ggpubr")
#install.packages("Hmisc")
#install.packages("lattice")
#install.packages("readxl")
#install.packages("sf")
#install.packages("sp")
#install.packages("survival")
#install.packages("tidyr")
#install.packages("tidyverse")

library(biogeo)
library(corrplot)
library(dendextend)
library(docxtractr)
library(factoextra)
library(Formula)
library(ggfortify)
library(ggplot2)
library(ggpubr)
library(Hmisc)
library(dplyr) # must be after Hmisc and raster to use "select" from it
library(lattice)
library(readxl)
library(sf)
library(sp)
library(survival)
library(tidyr)
library(tidyverse)
```


## Introduction
Under abiotic stress such as salinity, several morphological and physiological parameters of plants are affected. As function of their phenotypic diversity, plants from the same species can exhibit different tolerance to abiotic stress. In the study we will review, 25 accessions of *Eruca sativa* from different regions of Pakistan were analyzed. Each accession have been separated into two groups  according to the received treatment: first group underwent salt stress (150 mM NaCl) during two weeks and the second was the control. Lastly, 19 morpho-physiological traits were measured.

The data was obtained from the paper [**"Evaluation of salt tolerance in *Eruca sativa* accessions based on morpho-physiological traits"** 
(Afsar et. al 2020)](https://peerj.com/articles/9749/)

## Objectives and hypotheses
Our main objectives are:

1. Explore effects of salt stress on various morpho-physiological traits in different *E. sativa* accessions. 
2. Identify traits that salt stress has the biggest influence on.
3. Define tolerant and sensitive accessions.
4. Compare our results with the ones from the paper.
5. Explore if location can be linked to salt-tolerance.

Main hypotheses:

- We expect to observe statistically significant differences in morpho-physiological traits between control and salt-treated plants.
- Salt-tolerant and salt-susceptible accessions will belong to different groups based on how much salt stress affects morpho-physiological parameters.
- Geographical location and/or elevation may impact adaptation to salinity. 


## Methods 
### 1. Downloading and tidying the data.
First we had to download the data.xls file from the paper. The tables needed to be tidied (column names organized, empty cells filled, values formatted, etc.). Then we had to download the location of accessions.doc data and tidy this table as well.

In order to be able to work with all of morpho-physiological parameters, we had to unify them (because of different number of replicates in different categories of morpho-physiological traits measurements). The unification was done through the mean in every accession and treatment. With unified data we created a summary table (**Table 1.1**).

### 2. Test of normality and statistical difference of variables.
Once we had the summary table, we tested the normality of variables with 
Shapiro–Wilk test. Our Null Hypothesis (H0) was that morpho-physiological parameters' distribution was normal. The results for every group of morpho-physiological traits were summarized in tables (**Table 2.1-2.5**).

If the H0 was accepted (p > 0.05) we used ANOVA, otherwise (p < 0.05) we proceeded with Kruskal-Wallis test to see if there was a significant difference between salt-treated and control plants for each variable.
The parameters' distributions and results of normality tests were visualized in the boxplot figures (**Figure 2.1-2.19**)

Additionally, we calculated mean and standard deviation values of treated and control plants and summarized them into tables (**Table 2.6-2.7**).

### 3. Correlation analysis.
In order to see the degree of association between the morpho-physiological parameters (and additionally elevation), we performed Pearson correlation analysis. The results were visualized in the **Figure 3.1**.

We started doing Pearson correlation using Membership Function Values (MFV) of the 11 selected morpho-physiological traits, following the article logic. The results were very similar to the ones in the article, but we discarded them as we didn't understand their utility. Instead we computed Pearson correlation on the means of all morpho-physiological traits (treatment and control). Consecutively, we were able to see (prior to calculating MFV) which values had positive correlation and which had the negative. That allowed us to choose the appropriate formula for MFV calculation (explanation of MFV calculation is in the next sections).

### 4. Salt Tolerance Index (STI)
To evaluate degree of salt tolerance (so that later we can define the tolerant and sensitive accessions), we needed to convert all morpho-physiological parameters (control and treatment) for each accession to the Salt-tolerance Index (STI). STI is the ratio of the values of every morpho-physiological parameters of treated plants to control:

<center> **$STI=Vtreatment/Vcontrol$** </center>

At this point we deviated from the paper in the method of STI calculation. We considered that the way the authors calculated STI on accessions was not appropriate, because we think that they arbitrary paired plants from treatment and control. Instead, we calculated STI ratio on the means of treated plants and control for every parameter. STI results are summarized in the **Table 4.1**.

### 5. Membership function value (MFV)
Membership Function Value allows to make the different variables comparable between each other, so they can be used together in order to make a ranking.
We calculated the MVF values using the formula provided in the article:

<center> **$Xp=[(X−Xmin)/(Xmax−Xmin)]×100%$** </center>

For the traits inversely related to salt tolerance (Electrolyte leakage, Na, K, Ca) we used the second formula:

<center> **$Xp=[1−(X−Xmin)/(Xmax−Xmin)]×100%$** </center>

To define which morpho-physiological parameters were inversely related, we used the results of the correlation analysis. MFV calculation results are summarized in the Table 5.1.

### 6. The Principal Component Analysis (PCA)
 
The Principal Component Analysis (PCA) allows to reduce the dimensionality of a multivariate data to two (or more) principal components, that can be visualized graphically. We performed PCA using MFV values of selected variables. **RWC** and **ICO2** were excluded because they did not show significant difference between treatment and control (according to Kruskal-Wallis and ANOVA tests). **Mg**, and **Ca** were excluded because they showed little correlation with the rest of the parameters (according to the Pearson correlation analysis). **K** and **Na** also showed somewhat lesser extent of correlation, but the main reason for their exclusion was the availability of **K/Na** ratio, that, basically, unified the two. Thus we included the following traits into the PCA: **SL**, **RL**, **PH**, **LN**, **LA**, **FW**, **DW**, **EL**, **CC**, **K_Na**, **PR**, **TR**, **SC**.

The results were plotted. First plot represented contribution of principal components to the variance of the data (**Figure 8.1**). Second plot is the scatter plot individuals (our data) allowed us to visualize the groupings among accessions (**Figure 8.2**). It must be mentioned that initial analysis did not contain these groupings, they were added after cluster analysis results for additional visualization and do not interfere with data projections in any way. The third plot is the loadings correlation circle (**Figure 8.3**). It gives an idea about how the variables contribute to data projection on the principal components. The last plot was used to conclude the choice of main variables, that contributes to salt tolerance (**Figure 8.4**). Red dashed line is the mean contribution percentage of all the variables in the first principal component. It was our cessation level for the choice of the main variables for MFV ranking and cluster analysis.

### 7. Salt-tolerance evaluation: ranking and dendrogram 
To evaluate salt tolerance, we needed to group accessions that behave similarly under salt stress. This was achieved, based on the MFV mean of the 6 highest ranked physio-morphological parameters from PCA analysis (**PH**, **SL**,  **LN**, **RL**, **DW**, **FW**). 

The ranking was done by ordering MFV mean values from the highest to the smallest. Then the groups were addressed according to the PCA visualization and dendrogram clustering, both methods allowed us to identify 3 groups ranked from tolerant, moderately tolerant to susceptible.

The dendrogram was established based on MFV mean (6 highest values) and 3 groups were formed according to the biggest distance between them.

### 8. Accessions map and location correlation
To visually evaluate possible link between accession salt tolerance and their location we created a map, where each accession was presented and colored according to the salt tolerance ranking.
To make data more readable overlapping accessions were removed with a code.

Additionally, we wanted to check if the salt tolerance was correlated to elevation. So we made a Pearson correlation analysis between MFV mean (6 highest) and elevation. The results were presented in the **Table 8.1**

## Results 
### 1. Data download and transformation
```{r Tidy_data.R, message=FALSE}
###----Data download and transformation----###

##Downloading the .xlsx data
#download excel sheet from internet and store it into an Excel object
Excel <- "https://dfzljdn9uc3pi.cloudfront.net/2020/9749/1/Raw_data_Afsar_et_al.%2C_2020-PeerJ_20.5.2020.xlsx"

#create the folder "data" if it doesn't exist
D <- "data"
if (!dir.exists(D)) dir.create(D)
f <- paste0 (D, "/data.xlsx")

#download excel into the folder "data" (created beforehand) under the name "data.xlsx"
download.file(Excel, f, mode="wb")

#get the names of the excel sheets
excel.sheet <- excel_sheets(f)

##Tidying the .xlsx data
#create a list with the 4 sheet table from excel to tidy it further
X <- list()
for (i in excel.sheet){
  X[[i]] <- as.data.frame(read_xlsx(f,i))
}

#organize column names and fill the first 2 columns
for(i in names(X)){
  names(X[[i]])[1:3] <- c("Number", "Code", "Treat_Contr")
  X[[i]] <- X[[i]][-1,]
  X[[i]] <- fill(X[[i]], 1:2)
}

#transforming columns' data format 
for (i in seq_along(X)){
  X[[i]][2:3] <- lapply(X[[i]][2:3], as.factor)
  X[[i]][-(2:3)] <- lapply(X[[i]][-(2:3)], as.numeric)
}

#creating data frames from different .xlsx sheets
Morpho_t <- X$`Morphological traits`
Weight_ion <- X$`FW DW RWC Ions EL`
Chloro_c <- X$`Chlorophyll content`
Gas_e <- X$`Gas Exchange parameters`

#changing names of the columns for more convenient use
names(Morpho_t)[4:8] <- c('Shoot_Length', 
                          'Root_Length', 
                          'Plant_Height', 
                          'Leaf_Number', 
                          'Leaf_Area')
names(Chloro_c)[4] <- c('Chlorophyll_Content')
names(Weight_ion) [4:12] <- c('Fresh_Weight', 
                              'Dry_Weight', 
                              'Relative_water_content',
                              'Na',
                              'K', 
                              'Ca', 
                              'Mg', 
                              'K_Na', 
                              'Electrolyte_Leakage')
names(Gas_e) [4:7] <- c('Photsynthesis_Rate', 
                        'Intercellular_CO2', 
                        'Transpiration_Rate', 
                        'Stomatal_Conductance')

#adding NA cells into the missing 7th and 16th accession
#creating a data frame with the missing data first
Gas_e_miss <- data.frame (Number = rep(c(7, 16), each = 8),
                          Code = rep(c("Es-7", "Es-16"), each = 8),
                          Treat_Contr = rep(c("Treatment", "Control",
                                            "Treatment", "Control"), each = 4),
                          Photsynthesis_Rate = rep(NA, 16),
                          Intercellular_CO2 = rep(NA, 16),
                          Transpiration_Rate = rep(NA, 16),
                          Stomatal_Conductance = rep(NA, 16))

#changing the numbers in "Number" column
Gas_e$Number <- replace(Gas_e$Number, , rep(c(1:6, 8:15, 17:25), each = 8))

#adding NA cells into the missing 7th and 16th accession
if (!(is.element('Es-7', Gas_e$Code))) Gas_e <- rbind(Gas_e, Gas_e_miss)

#sorting the variables according to Number
Gas_e <- Gas_e[order(Gas_e$Number),]

#rewriting row names to correspond to the ordered data
row.names(Gas_e) <- c(1:200)

##Downloading the .docx data
#downloading data for the location of accessions
word <- "https://dfzljdn9uc3pi.cloudfront.net/2020/9749/1/Table_S1.docx"
w <- paste0(D, "/location.docx")
download.file(word, w, mode="wb")

##Tidying the .docx data
#creating data frame for the location of accessions
Acc_loc <- docx_extract_all_tbls(read_docx(w, track_changes = NULL),
                                 guess_header = TRUE, preserve = FALSE,
                                 trim = TRUE)
Acc_loc <- as.data.frame(Acc_loc)

#removing m from Elevation column 
Acc_loc$Elevation <- sub(' m', '', Acc_loc$Elevation)

#transforming data in the accession_loc
Acc_loc[c(1,6)] <- lapply(Acc_loc[c(1,6)], as.numeric)
Acc_loc[-c(1,6)] <- lapply(Acc_loc[-c(1,6)], as.factor)

#In order to fit the length of this table to the length of the ultimate table
#we need to double all the rows
Acc_loc_double <- Acc_loc[rep(1:25, each = 2), ]

## Creating the summarized table to work with
#create summary table for morphological trait
a <- Morpho_t %>% 
  group_by(Number, Code, Treat_Contr) %>% 
  summarise(Shoot_Length = mean(Shoot_Length),
            Root_Length = mean(Root_Length), 
            Plant_Height = mean(Plant_Height), 
            Leaf_Number = mean(Leaf_Number), 
            Leaf_Area = mean(Leaf_Area))

# remove NA values from Weight_ion table
Weight_ion <- na.omit(Weight_ion)
#Create summary table for Weight ion
b <- Weight_ion %>% 
  group_by(Number, Code, Treat_Contr) %>% 
  summarise(Fresh_Weight= mean(Fresh_Weight),
            Dry_Weight= mean(Dry_Weight),
            Relative_water_content = mean(Relative_water_content),
            Na =mean(Na),
            K =mean(K),
            Ca =mean(Ca),
            Mg= mean(Mg),
            K_Na =mean(K_Na),
            Electrolyte_Leakage= mean(Electrolyte_Leakage))
#take only the columns number 4 to 12 to avoid repetition of number, code and treatment
b <- b[4:12] 

#Create summary table for Weight_ion
c <- Chloro_c %>% 
  group_by(Number, Code, Treat_Contr) %>% 
  summarise(Chlorophyll_Content = mean(Chlorophyll_Content))
#take only the column number 4 to avoid repetition of number, code and treatment
c <- c[4]  

#Create summary table for Gas_e
d <- Gas_e %>% 
  group_by(Number, Code, Treat_Contr) %>% 
  summarise(Photsynthesis_Rate= mean(Photsynthesis_Rate),
            Intercellular_CO2= mean(Intercellular_CO2), 
            Transpiration_Rate= mean(Transpiration_Rate), 
            Stomatal_Conductance=mean(Stomatal_Conductance))
#take only the columns number 4 to 7 to avoid repetition of number, code and treatment
d <- d[4:7]

#add Acc_loc data to the table
e <- Acc_loc_double
e <- e[6]

#create data frame with all the summarized tables 
table <- data.frame(a, b, c, d, e)

##Creating the caption for the summary table
knitr::kable(table, caption = "Table 1.1 Mean values of salt tolerance traits for each accession and treatment type", align="c" , digits = round(2))
```

### 2. Initial statistical analysis. Normality test and significant difference test
#### 2.1 Morphological traits
There is a statistical difference between control and treatment for all morphological traits

- **Shoot length (SL)**: Shoot length is significantly reduced in the salt-stressed plants compared with the control (p < 0.05). The mean value for SL in salt-stressed plants is 1.10 ± 0.48 and 2.30 ± 0.56 for control plants. SL stress index of accessions varied from 16.73 to 89.12

- **Root length (RL)**: Root length is significantly reduced in the salt-stressed plants compared with the control (p < 0.05). The mean value for RL in salt-stressed plants is 0.98 ± 0.43 and 2.17 ± 0.42 for control plants. 
RL stress index of accessions varied from 15.91 to 73.53 

- **Plant height (PH)**: Plant height is significantly reduced in the salt-stressed plants compared with the control (p < 0.05).
The mean value for PH in salt-stressed plants is 2.18 ± 0.76 and 4.43 ± 0.77 for control plants. 
PH stress index of accessions varied from 19.83 to 74.07 

- **Leaf number (LN)**: Number of leaves is significantly reduced in the salt-stressed plants compared with the control (p < 0.05).
The mean value for LN in salt-stressed plants is 2.43 ± 0.82 and 4.22 ± 0.78 for control plants. 
LN stress index of accessions varied from 28.00 to 94.12

- **Leaf area (LA)**: Leaf area is significantly reduced in the salt-stressed plants compared with the control (p < 0.05).
The mean value for LA in salt-stressed plants is 0.03 ± 0.02 and 0.07 ± 0.03 for control plants. 
LA stress index of accessions varied from 75.95 to 100

```{r Normality test of morphological traits}
#Performing Shapiro–Wilk test of normality
spm <- numeric()
nor_spm <- c()
for(i in names(Morpho_t[4:8])) { 
  an1 <- aov(Morpho_t[, i] ~ Morpho_t$Treat_Contr)
  spm[i] <- shapiro.test(an1$residuals)$p.value
  nor_spm <- c(nor_spm, ifelse (spm[i] <= 0.05, "False", "True"))
}
#Creating summary table with the results
spm_table <- data.frame ("P-value" = spm, "Normality" = nor_spm)

#Creating the caption for the summary table
knitr::kable(spm_table, caption = "Table 2.1 Shapiro–Wilk test results for morphological traits", align="c", digits = 32)
```

```{r Significance test of morphological traits}
#Performing significance test and plotting the results and values distribution
for (i in (4:8)) {
  bmorpho <- ggboxplot(Morpho_t,
                       x = "Treat_Contr",
                       y = names(Morpho_t[i]),
                       color = names(Morpho_t[3]),
                       palette = c("blue", "red"),
                       add = "jitter") +
    stat_compare_means(data = Morpho_t, method = "kruskal.test",
                       label.x.npc = "center",
                       label.y.npc = "top") +
    theme(legend.position = "None") +
     labs(x = "", title = paste("Boxplot of the", names(Morpho_t[i])),
         caption = paste("Figure 2.", (i-3), " Distribution of the mean values of the ", names(Morpho_t[i]), sep = ""))
  print(bmorpho)
}
```

#### 2.2 Biomass traits
- **Fresh weight (FW)**:
Fresh weight is significantly reduced in the salt-stressed plants compared with the control (p < 0.05).
The mean value for FW in salt-stressed plants 96.22 ± 66.00 and 241.06 ± 164.75 for control plants.
FW stress index of accessions varied from 10.20 to 83.93


- **Dry weight (DW)**:
Dry weight is significantly reduced in the salt-stressed plants compared with the control (p < 0.05).
The mean value for DW in salt-stressed plants is 6.26 ± 4.00 and 10.58 ± 6.89 for control plants.
DW stress index of accessions varied from 24.67 to 88.26

```{r Normality test of biomass traits}
#Performing Shapiro–Wilk test of normality
spb <- numeric()
nor_spb <- c()
for(i in names(Weight_ion[4:5])) { 
  an2 <- aov(Weight_ion[, i] ~ Weight_ion$Treat_Contr)
  spb[i] <- shapiro.test(an2$residuals)$p.value
  nor_spb <- c(nor_spb, ifelse (spb[i] <= 0.05, "False", "True"))
}

#Creating summary table with the results
spb_table <- data.frame ("P-value" = spb, "Normality" = nor_spb)

#Creating the caption for the summary table
knitr::kable(spb_table, caption = "Table 2.2 Shapiro–Wilk test results for biomass traits", align="c", digits = 32)
```

```{r Significance test of biomass traits}
#Performing significance test and plotting the results and values distribution
for (i in (4:5)) {
  bwei <- ggboxplot(Weight_ion, 
                 x = "Treat_Contr",
                 y = names(Weight_ion[i]), 
                 color = names(Weight_ion[3]),
                 palette = c("blue", "red"),
                 add = "jitter") + 
    stat_compare_means(data = Weight_ion, method = "kruskal.test",
                       label.x.npc = "center",
                       label.y.npc = "top") +
    theme(legend.position = "None") +
    labs(x = "", title = paste("Boxplot of the", names(Weight_ion[i])),
         caption = paste("Figure 2.", (i+2), " Distribution of the mean values of the ", names(Weight_ion[i]), sep = ""))
  print(bwei)
} 
```

#### 2.3 Relative water content (RWC), electrolyte leakage (EL) and chlorophyll content (CC)
- **Relative water content (RWC)**:
Relative water content is not significantly different in the salt-stressed plants compared with the control (p > 0.05).
The mean value for RWC in salt-stressed plants 92.77 X ± 2.65 and 92.10 ± 7.00 for control plants.


- **Electrolyte leakage (EL)**:
Electrolyte leakage is significantly increased in the salt-stressed plants compared with the control (p < 0.05).
The mean value for EL in salt-stressed plants is 60.60 ± 9.32 and 56.51 ± 6.48 for control plants.


- **Chlorophyll content (CC)**: 
Chlorophyll content is significantly reduced in the salt-stressed plants compared with the control (p < 0.05).
The mean value for CC in salt-stressed plants is 14.06 ± 6.02 and 18.17 ± 4.79 for control plants.
```{r Normality test of RWC, EL and CC}
#Performing Shapiro–Wilk test of normality on the RWC and EL
spe <- numeric()
nor_spe <- c()
for(i in names(Weight_ion[c(6,12)])) { 
  an3 <- aov(Weight_ion[, i] ~ Weight_ion$Treat_Contr)
  spe[i] <- shapiro.test(an3$residuals)$p.value
  nor_spe <- c(nor_spe, ifelse (spe[i] <= 0.05, "False", "True"))
}

#Creating summary table with the results for RWC and EL
spe_table <- data.frame ("P-value" = spe, "Normality" = nor_spe)

#Performing Shapiro–Wilk test of normality on the CC
nor_spc <- c()
an4 <- aov(Chloro_c$Chlorophyll_Content ~ Chloro_c$Treat_Contr)
spc <- shapiro.test(an4$residuals)$p.value

#Creating summary table with the results for CC
nor_spc <- c(nor_spc, ifelse (spc <= 0.05, "False", "True"))
spc_table <- data.frame ("P-value" = spc, "Normality" = nor_spc)
row.names(spc_table) <- "Chlorophyll_Content"

#Uniting the summary tables with the results for RWC+EL and CC
spec_table <- dplyr::bind_rows(spe_table, spc_table)

#Creating the caption for the summary table
knitr::kable(spec_table, caption = "Table 2.3 Shapiro–Wilk test results for RWC, EL and CC", align="c", digits = 32)
```

```{r Significance test of RWC, EL and CC}
#for RWC and EL
for (i in (c(6,12))) {
  bwei2 <- ggboxplot(Weight_ion, 
                 x = "Treat_Contr",
                 y = names(Weight_ion[i]), 
                 color = names(Weight_ion[3]),
                 palette = c("blue", "red"),
                 add = "jitter") + 
    stat_compare_means(data = Weight_ion, method = "kruskal.test",
                       label.x.npc = "center",
                       label.y.npc = "top") +
    theme(legend.position = "None") +
     labs(x = "", title = paste("Boxplot of the", names(Weight_ion[i])),
          caption = paste("Figure 2.", ifelse((i<7), paste(i+2), paste(i-3)), " Distribution of the mean values of the ", names(Weight_ion[i]), sep = ""))
  print(bwei2)
} 
#for CC
bchlo <- ggboxplot(Chloro_c, 
                 x = "Treat_Contr",
                 y = "Chlorophyll_Content", 
                 color = names(Chloro_c[3]),
                 palette = c("blue", "red"),
                 add = "jitter") 
bchlo + stat_compare_means(data = Chloro_c, method = "kruskal.test", 
                           label.x.npc = "center",
                           label.y.npc = "top") +
  theme(legend.position = "None") +
   labs(x = "", title = paste("Boxplot of the", names(Chloro_c[4])),
         caption = paste("Figure 2.10 Distribution of the mean values of the", names(Chloro_c[4])))
```

#### 2.4 Mineral ion content
- **Sodium (Na)**:
Sodium is significantly increased in the salt-stressed plants compared with the control (p < 0.05).
The mean value for Na in salt-stressed plants is 30.03 ± 8.84 and 13.60 ± 5.00 for control plants.


- **Potassium (K)**:
Potassium is significantly increased in the salt-stressed plants compared with the control (p < 0.05).
The mean value for K in salt-stressed plants is 19.72 ± 7.48 and 15.48 ± 6.09 for control plants.


- **Calcium (Ca)**:
Calcium is significantly increased in the salt-stressed plants compared with the control (p < 0.05).
The mean value for Ca in salt-stressed plants is 9.12 ± 5.32 and 6.03 ± 2.60 for control plants.


- **Magnesium (Mg)**:
Magnesium is significantly reduced in the salt-stressed plants compared with the control (p < 0.05).
The mean value for Mg in salt-stressed plants is 4.37 ± 1.83 and 5.95 ± 2.85 for control plants.


- **K/Na ratio**:
K/Na ratio is significantly reduced in the salt-stressed plants compared with the control (p < 0.05).
The mean value for K/Na ratio in salt-stressed plants is 0.67 ± 0.20 and 1.20 ± 0.36 for control plants.
```{r Normality test of mineral ion content}
#Performing Shapiro–Wilk test of normality
spw <- numeric()
nor_spw <- c()
for(i in names(Weight_ion[7:11])) { 
  an5 <- aov(Weight_ion[, i] ~ Weight_ion$Treat_Contr)
  spw[i] <- shapiro.test(an5$residuals)$p.value
  nor_spw <- c(nor_spw, ifelse (spw[i] <= 0.05, "False", "True"))
}

#Creating summary table with the results
spw_table <- data.frame ("P-value" = spw, "Normality" = nor_spw)

#Creating the caption for the summary table
knitr::kable(spw_table, caption = "Table 2.4 Shapiro–Wilk test results for mineral ion content ", align="c", digits = 32)
```

```{r Significance test of mineral ion content}
#Performing significance test and plotting the results and values distribution
for (i in (7:11)) {
  bwei3 <- ggboxplot(Weight_ion, 
                 x = "Treat_Contr",
                 y = names(Weight_ion[i]), 
                 color = names(Weight_ion[3]),
                 palette = c("blue", "red"),
                 add = "jitter") + 
    stat_compare_means(data = Weight_ion, method = "kruskal.test",
                       label.x.npc = "center",
                       label.y.npc = "top") +
    theme(legend.position = "None") +
    labs(x = "", title = paste("Boxplot of the", names(Weight_ion[i])),
         caption = paste("Figure 2.", (i+4), " Distribution of the mean values of the ", names(Weight_ion[i]), sep = ""))
  print(bwei3)
}
```

#### 2.5 Gas exchange attributes
- **Photosynthesis rate (PR)**:
Photosynthesis rate is significantly reduced in the salt-stressed plants compared with the control (p < 0.05).
The mean value for PR in salt-stressed plants is 1.95 ± 1.02 and 7.53 ± 4.84 for control plants.

- **Intercellular CO2 (ICO2)**:
Intercellular CO2 is not significantly different in the salt-stressed plants compared with the control (p < 0.05).
The mean value for ICO2 in salt-stressed plants is 284.70 ± 42.57 and 281.20 ± 22.90 for control plants.

- **Transpiration rate (TR)**:
Transpiration rate is significantly reduced in the salt-stressed plants compared with the control (p < 0.05).
The mean value for TR in salt-stressed plants is 0.94 ± 0.48 and 2.57 ± 1.13 for control plants.

- **Stomatal conductance (SC)**:
Stomatal conductance is significantly reduced in the salt-stressed plants compared with the control (p < 0.05).
The mean value for SC in salt-stressed plants is 0.039 ± 0.02 and 0.15 ± 0.08 for control plants.

```{r Normality test of gas exchange attributes}
#Performing Shapiro–Wilk test of normality
spg <- numeric()
nor_spg <- c()
for (i in names(Gas_e[c(4:7)])) { 
  an6 <- aov(Gas_e[, i] ~ Gas_e$Treat_Contr)
  spg[i] <- shapiro.test(an6$residuals)$p.value
  nor_spg <- c(nor_spg, ifelse (spg[i] <= 0.05, "False", "True"))
}

#Creating summary table with the results
spg_table <- data.frame ("P-value" = spg, "Normality" = nor_spg)

#Creating the caption for the summary table
knitr::kable(spg_table, caption = "Table 2.5 Shapiro–Wilk test results for gas exchange attributes", align="c", digits = 32)
```

```{r Significance test of gas exchange attributes}
#Performing significance test and plotting the results and values distribution
#for intercellular CO2 (with ANOVA results, as this is the only normally distributed value)
Gas_e_withoutNA <- na.omit(Gas_e)
banova <- ggboxplot(Gas_e_withoutNA,
          x="Treat_Contr", 
          y= "Intercellular_CO2",
          color = names(Gas_e_withoutNA[3]),
          palette = c("blue", "red"),
          add = "jitter") 
banova  +   stat_compare_means(method = "anova") +
  theme(legend.position = "None") +
  labs(x = "", title = paste("Boxplot of the", names(Gas_e_withoutNA[5])),
       caption = paste("Figure 2.16 Distribution of the mean values of the", names(Gas_e_withoutNA[5])))
#for photosynthesis rate, transpiration rate, stomatal conductance
#(with Kruskal-Wallis results)
for (i in c(4,6:7)) {
  bgas <- ggboxplot(Gas_e_withoutNA, 
                 x = "Treat_Contr",
                 y = names(Gas_e_withoutNA[i]), 
                 color = names(Gas_e_withoutNA[3]),
                 palette = c("blue", "red"),
                 add = "jitter") + 
    stat_compare_means(data = Gas_e_withoutNA, method = "kruskal.test",
                       label.x.npc = "center",
                       label.y.npc = "top") +
    theme(legend.position = "None") +
    labs(x = "", title = paste("Boxplot of the", names(Gas_e_withoutNA[i])),
         caption = paste("Figure 2.", ifelse((i<5), paste(i+13), paste(i+12)), " Distribution of the mean values of the ", names(Gas_e_withoutNA[i]), sep = ""))
  print(bgas)
}
```

```{r recap table for mean and median}
x <- data.frame(dplyr::filter(table, table$Treat_Contr=="Treatment"))
x <- x[-(1:3)]
y <- data.frame(dplyr::filter(table, table$Treat_Contr=="Control"))
y <- y[-(1:3)]

Mean_Treat <- x %>% 
  summarise(Mean_SL = mean(Shoot_Length),
            Mean_SL = mean(Root_Length), 
            Mean_PH = mean(Plant_Height), 
            Mean_LN = mean(Leaf_Number), 
            Mean_LA = mean(Leaf_Area),
            Mean_FW = mean(Fresh_Weight),
            Mean_DW = mean(Dry_Weight),
            Mean_RWC = mean(Relative_water_content),
            Mean_Na = mean(Na),
            Mean_K = mean(K),
            Mean_Ca = mean(Ca),
            Mean_Mg = mean(Mg),
            Mean_K_Na = mean(K_Na),
            Mean_EL = mean(Electrolyte_Leakage),
            Mean_CC = mean(Chlorophyll_Content),
            Mean_PR = mean (Photsynthesis_Rate, na.rm=T),
            Mean_ICO2 = mean(Intercellular_CO2, na.rm=T),
            Mean_TR = mean(Transpiration_Rate, na.rm=T),
            Mean_S = mean(Stomatal_Conductance, na.rm=T)) 
Mean_Control <- y %>% 
  summarise(Mean_SL = mean(Shoot_Length),
            Mean_SL = mean(Root_Length), 
            Mean_PH = mean(Plant_Height), 
            Mean_LN = mean(Leaf_Number), 
            Mean_LA = mean(Leaf_Area),
            Mean_FW = mean(Fresh_Weight),
            Mean_DW = mean(Dry_Weight),
            Mean_RWC = mean(Relative_water_content),
            Mean_Na = mean(Na),
            Mean_K = mean(K),
            Mean_Ca = mean(Ca),
            Mean_Mg = mean(Mg),
            Mean_K_Na = mean(K_Na),
            Mean_EL = mean(Electrolyte_Leakage),
            Mean_CC = mean(Chlorophyll_Content),
            Mean_PR = mean (Photsynthesis_Rate, na.rm=T),
            Mean_ICO2 = mean(Intercellular_CO2, na.rm=T),
            Mean_TR = mean(Transpiration_Rate, na.rm=T),
            Mean_S = mean(Stomatal_Conductance, na.rm=T)) 
Treatment <- c('Treatment','Control')
Means <- rbind(Mean_Treat, Mean_Control)
Means$Treat_Contr <- Treatment

Sd_Treatment <- x %>%
    summarise(SD_SL = sd(Shoot_Length),
            SD_RL = sd(Root_Length),
            SD_PH = sd(Plant_Height),
            SD_LN = sd(Leaf_Number),
            SD_LA = sd(Leaf_Area),
            SD_FW = sd(Fresh_Weight),
            SD_DW = sd(Dry_Weight),
            SD_RWC = sd(Relative_water_content),
            SD_Na = sd(Na),
            SD_K = sd(K),
            SD_Ca = sd(Ca),
            SD_Mg = sd(Mg),
            SD_K_NA = sd(K_Na),
            SD_EL = sd(Electrolyte_Leakage),
            SD_CC = sd(Chlorophyll_Content),
            SD_PR = sd (Photsynthesis_Rate, na.rm=T),
            SD_I_CO2 = sd(Intercellular_CO2, na.rm=T),
            SD_TR = sd(Transpiration_Rate, na.rm=T),
            SD_SC = sd(Stomatal_Conductance, na.rm=T))
Sd_Control <-   y %>%
  summarise(SD_SL = sd(Shoot_Length),
            SD_RL = sd(Root_Length),
            SD_PH = sd(Plant_Height),
            SD_LN = sd(Leaf_Number),
            SD_LA = sd(Leaf_Area),
            SD_FW = sd(Fresh_Weight),
            SD_DW = sd(Dry_Weight),
            SD_RWC = sd(Relative_water_content),
            SD_Na = sd(Na),
            SD_K = sd(K),
            SD_Ca = sd(Ca),
            SD_Mg = sd(Mg),
            SD_K_NA = sd(K_Na),
            SD_EL = sd(Electrolyte_Leakage),
            SD_CC = sd(Chlorophyll_Content),
            SD_PR = sd (Photsynthesis_Rate, na.rm=T),
            SD_I_CO2 = sd(Intercellular_CO2, na.rm=T),
            SD_TR = sd(Transpiration_Rate, na.rm=T),
            SD_SC = sd(Stomatal_Conductance, na.rm=T))
Treatment <- c('Treatment','Control')
SD <- rbind(Sd_Treatment,Sd_Control)
SD$Treat_Contr <- Treatment

knitr::kable(Means, caption = "Table 2.6 Summary table for the mean of treated and control plants")
knitr::kable(SD, caption = "Table 2.7 Summary table for the standard deviation (SD) of treated and control plants")
```


### 3. Pearson correlation 
```{r Pearson test, fig.cap = "Figure 3.1. Pearson correlation table for all variables. X represent non-significative correlation (p-value > 0.05)"}
# create a table with all the variables but without 3 first columns
all_data <- na.omit(table[4:23])
#perform Pearson correlation test
res1 <- cor.mtest(all_data, conf.level = .95)
#Plot the results
M1 <-cor(all_data)
corrplot(M1, p.mat = res1$p, sig.level = .05, type = "lower")
```
We can see that morphological traits are positively and strongly correlated (close to 1). Biomass is also positively correlated to morphological traits. 


### 4. Salt tolerance index (STI)
```{r STI}
x <- data.frame(dplyr::filter(table, table$Treat_Contr=="Treatment"))
x <- x[-(1:3)]
y <- data.frame(dplyr::filter(table, table$Treat_Contr=="Control"))
y <- y[-(1:3)]
#salt tolerance index for morphological traits
STI_SL <- x[1]/y[1]
STI_RL <- x[2]/y[2]
STI_PH <- x[3]/y[3]
STI_LN <- x[4]/y[4]
STI_LA <- x[5]/y[5]
#salt tolerance index for biomass
STI_FW <- x[6]/y[6]
STI_DW <- x[7]/y[7]
#salt tolerance index for RWC, EL and Chlorophyll content
STI_RWC  <- x[8]/y[8]
STI_EL  <- x[14]/y[14]
STI_CC <- x[15]/y[15]
#salt tolerance index for Mineral ion content
STI_Na <- x[9]/y[9]
STI_K <- x[10]/y[10]
STI_Ca <- x[11]/y[11]
STI_Mg <- x[12]/y[12]
STI_K_Na <- x[13]/y[13]
# salt tolerance index for gas exchange attributes
STI_PR <- x[16]/y[16]
STI_ICO2 <- x[17]/y[17]
STI_TR <- x[18]/y[18]
STI_SC <- x[19]/y[19]
#Creating a summary data.frame
STI <- data.frame(STI_SL,
                  STI_RL, 
                  STI_PH, 
                  STI_LN, 
                  STI_LA, 
                  STI_FW, 
                  STI_DW,
                  STI_RWC, 
                  STI_EL,
                  STI_Na,
                  STI_K,
                  STI_Ca,
                  STI_Mg,
                  STI_K_Na,
                  STI_CC,
                  STI_PR,
                  STI_ICO2,
                  STI_TR,
                  STI_SC)
#setting names of columns to compact the table view
STI_names <- c("STI_SL", "STI_RL", "STI_PH", "STI_LN", "STI_LA", "STI_FW", "STI_DW", "STI_RWC", "STI_EL", "STI_Na", "STI_K",
               "STI_Ca", "STI_Mg", "STI_K_Na", "STI_CC", "STI_PR", "STI_ICO2", "STI_TR", "STI_SC")
names(STI) <- STI_names
#Creating a table with the results and a caption for it
knitr::kable(STI, caption = "Table 4.1. Summary table for salt tolerance indices", align="c", digits = round(2))
```


### 5. Membership function value (MFV) 
```{r MFV}
#Membership function value 
library(dplyr)
# 1-results for the traits inversely related to salt tolerance: which are electrolyte leakage, Na, K and Ca
MFV <- STI %>%
  mutate(SL = (STI$STI_SL - min(STI$STI_SL))/(max(STI$STI_SL)- min(STI$STI_SL)),
         RL = (STI$STI_RL - min(STI$STI_RL))/(max(STI$STI_RL)- min(STI$STI_RL)),
         PH = (STI$STI_PH - min(STI$STI_PH))/(max(STI$STI_PH)- min(STI$STI_PH)),
         LN = (STI$STI_LN - min(STI$STI_LN))/(max(STI$STI_LN)- min(STI$STI_LN)),
         LA = (STI$STI_LA - min(STI$STI_LA))/(max(STI$STI_LA)- min(STI$STI_LA)),
         FW = (STI$STI_FW - min(STI$STI_FW))/(max(STI$STI_FW)- min(STI$STI_FW)),
         DW = (STI$STI_DW - min(STI$STI_DW))/(max(STI$STI_DW)- min(STI$STI_DW)),
         RWC = (STI$STI_RWC - min(STI$STI_RWC))/(max(STI$STI_RWC)- min(STI$STI_RWC)),
         EL = 1-(STI$STI_EL - min(STI$STI_EL))/(max(STI$STI_EL)- min(STI$STI_EL)),
         CC = (STI$STI_CC - min(STI$STI_CC))/(max(STI$STI_CC)- min(STI$STI_CC)),
         Na = 1-(STI$STI_Na - min(STI$STI_Na))/(max(STI$STI_Na)- min(STI$STI_Na)),
         K = 1-(STI$STI_K - min(STI$STI_K))/(max(STI$STI_K)- min(STI$STI_K)),
         Ca = 1- (STI$STI_Ca - min(STI$STI_Ca))/(max(STI$STI_Ca)- min(STI$STI_Ca)),
         Mg = (STI$STI_Mg - min(STI$STI_Mg))/(max(STI$STI_Mg)- min(STI$STI_Mg)),
         K_Na = (STI$STI_K_Na - min(STI$STI_K_Na))/(max(STI$STI_K_Na)- min(STI$STI_K_Na)),
         PR = (STI$STI_PR - min(STI$STI_PR, na.rm=T))/(max(STI$STI_PR, na.rm=T)- min(STI$STI_PR, na.rm=T)),
         ICO2 = (STI$STI_ICO2 - min(STI$STI_ICO2, na.rm=T))/(max(STI$STI_ICO2, na.rm=T)- min(STI$STI_ICO2, na.rm=T)),
         TR = (STI$STI_TR - min(STI$STI_TR, na.rm=T))/(max(STI$STI_TR, na.rm=T)- min(STI$STI_TR, na.rm=T)),
         SC = (STI$STI_SC - min(STI$STI_SC, na.rm=T))/(max(STI$STI_SC, na.rm=T)- min(STI$STI_SC, na.rm=T)))%>%
  select(SL, RL, PH, LN, LA, FW, DW, RWC, EL, CC, Na, K, Ca, Mg, K_Na, PR, ICO2, TR, SC)
#Creating a table with the results and a caption for it
knitr::kable(MFV, caption = "Table 5.1. Summary table of membership function values (MFV) calculated from STI", align="c", digits = round(2))
```


### 6. Principal component analysis (PCA)
As it was mentioned in the methods, we included 13 variables into the PCA: **SL**, **RL**, **PH**, **LN**, **LA**, **FW**, **DW**, **EL**, **CC**, **K/Na**, **PR**, **TR**, **SC**. PCA produced principal components with the variation contributed by the first 2 components equal to 53,3% (PC1 - 34,4% and PC2 - 18,9%).
```{r PCA, fig.cap = "Figure 6.1 Percent of variance of principal components"}
####------PCA on MFV-------###
#doing the PCA, adding the scaling into the function
MFV_salt <- na.omit(MFV[-c(8, 11:14, 17, 20)])
MFV_salt.pca <- prcomp(MFV_salt, 
                       scale. = TRUE)

#plotting the results in order to evaluate the principal components
PCA_eval <- fviz_eig(MFV_salt.pca,
                     title = "Variance contribution of principal components",
                     xlab = "Principal components")
print(PCA_eval)
```

The scatter plot (Figure 6.2) shows the projection of data on PC1 and PC2 dimensions, allowing us to recognize groups of accessions (according to their salt tolerance) defined by MFV ranking and cluster analysis. Different groups are represented by different colors as shown in the legend.  

```{r PCA_ind, fig.cap = "Figure 6.2 Plot of data projections onto the prinsipal components. Groups according to salt tolerance"}
#creating vector for colors to correspond to ranking of accessions
colors_PCA <- c("3. Tolerant", "2. Moderately tolerant", "1. Sensitive",
                "3. Tolerant", "2. Moderately tolerant", "2. Moderately tolerant",
                "2. Moderately tolerant", "3. Tolerant", "2. Moderately tolerant",
                "3. Tolerant", "3. Tolerant", "3. Tolerant", "2. Moderately tolerant",
                "1. Sensitive", "1. Sensitive", "1. Sensitive", "3. Tolerant",
                "2. Moderately tolerant", "2. Moderately tolerant",
                "2. Moderately tolerant", "2. Moderately tolerant",
                "2. Moderately tolerant", "2. Moderately tolerant")

#making a scatterplot of PC1 and PC2
PCA_ind <- fviz_pca_ind(MFV_salt.pca,
                        repel = TRUE, # Avoid text overlapping
                        labelsize = 5,
                        pointsize = 2,
                        habillage = colors_PCA,
                        addEllipses = TRUE,
                        ellipse.level = 0.95,
                        mean.point = FALSE,
                        palette = c("#FF3333", "#009966", "#3366CC"),
                        title = "PCA score plot")
print(PCA_ind)
```

The loading plot illustrates how much different traits contribute into data distribution (grouping). In particular, it shows that all morphological traits, as well as biomass characteristics, electrolyte leakage (in one direction) and K/Na ratio (in opposite direction) are responsible for distributing data projections along PC1. While gas characteristics (one direction) and chlorophyll content (opposite direction) contribute to data distribution along PC2.  

```{r PCA_var, fig.cap = "Figure 6.3 Correlation circle and loading scores of variables to principal components"}
#making loadings plot
PCA_var <- fviz_pca_var(MFV_salt.pca,
                        col.var = "#2E9FDF",
                        repel = TRUE,
                        title = "PCA loadings")
print(PCA_var)
```

The last figure (Figure 6.4) presents variables according to the percentage, that they contribute to principal component 1. Red dashed line, as was previously mentioned in the Methods, was the cut off line and allowed us to narrow the quantity of variables to the most important 6: **PH**, **SL**, **LN**, **RL**, **DW**, **FW**. Those variables were later used for MFV ranking and cluster analysis.

```{r PCA_contr, fig.cap = "Figure 6.4 Persentage of variables influence on the first principal component"}
#Contributions of variables to PC1
PCA_contr <- fviz_contrib(MFV_salt.pca,
                          choice = "var",
                          axes = 1,
                          top = 13,
                          sortcontrib = "asc",
                          title = "Contribution of variables to PC1")
print(PCA_contr)
```


### 7. Salt-tolerance evaluation: ranking and dendrogram
The ranking of accessions according to their salt tolerance is summarized in Table 7.1. However, the categories of salt tolerance were defined based on cluster analysis and can be seen in the dendrogram (Figure 7.1). Colors represents groups according to salt tolerance: tolerant - blue, moderately tolerate - green and sensitive - red. Therefore, 8 accessions were included into the tolerant group (accessions ## 12, 9, 1, 19, 11, 13, 4, 7), 4 accessions were included into the sensitive group (accessions ## 3, 18, 17, 15) and the rest were included into the moderately tolerant group (13 accessions: 5, 2, 6, 14, 20, 22, 10, 25, 21, 24, 23, 8, 16).

```{r MFV ranking}
# We used 6 highest ranked variables to include in the final MFV based ranking of salt tolerance
# Add into the data the mean MFV column from the 6 important variables 
MFV <- MFV %>%
  mutate(Mean = rowMeans(MFV[c(1:4, 6:7)], na.rm=T))%>%
  select(SL, RL, PH, LN, LA, FW, DW, RWC, EL, CC, Na, K, Ca, Mg, K_Na, PR, ICO2, TR, SC, Mean)

# create the ranking table out of MFV mean from 6 important variables
MFV_Ranked <- MFV[order(-MFV$Mean),]
MFV_Ranked <- MFV_Ranked[20]
MFV_Ranked$Category <- c(rep("Tolerant", 8), rep("Moderately tolerant", 13), rep("Sensitive", 4))

knitr::kable(MFV_Ranked, caption = "Table 7.1. Salt tolerance ranking based on MFV mean from 6 variables identified by PCA", align="c", digits = round(2))
```

```{r, fig.cap = "Figure 7.1. The MFV dendrogram based on 6 main variables identified by PCA"}

#data frame with MFV from 6 important variables of PCA
important_var <- MFV[c(1:4, 6:7)]

#make the dendrogram
dend <- important_var %>% 
  scale %>% 
  dist(method = "euclidean") %>% 
  hclust(method = "ward.D2") %>% 
  as.dendrogram %>%
  set("branches_k_color",                                   #setting the color 
      value = c("#FF3333", "#3366CC", "#009966"),           #of the branches 
      k = 3)%>% # make the 3 groups and color for groups    #according to the clusters
  plot(main = "MFV Dendrogram") # plot dendrogram
```


### 8. Map of accessions and elevation correlation analysis
#### 8.1 Location and salt tolerance.

The map of accessions showed no visible patterns of accessions distribution according to their salt tolerance ranking.
The only accession, whose tolerance might be linked to its location is Ess-1, that is closest to the coast.
```{r, fig.cap = "Figure 8.1. Map of *E. sativa* accessions"}
###--Map of accessions--###
#Creating data frame for the future map from Acc_loc table
map.acc <- data.frame(code = Acc_loc$Code,
                      lat = Acc_loc$Latitude,
                      long = Acc_loc$Longitude)
#separating longitude and latitude data into separate columns according to degrees minutes, seconds and cardinals
map.acc <- separate(map.acc, lat, c("lt.d", "lt.m", "lt.s", "lt.cr"))
map.acc <- separate(map.acc, long, c("ln.d", "ln.m", "ln.s", "ln.cr"))
#creating data frame with decimal coordinates
map.acc <- data.frame(code = map.acc$code,
                      Latitude = (dms2dd(as.numeric(map.acc$lt.d),
                                    as.numeric(map.acc$lt.m),
                                    as.numeric(map.acc$lt.s),
                                    map.acc$lt.cr)),
                      Longitude = (dms2dd(as.numeric(map.acc$ln.d),
                                     as.numeric(map.acc$ln.m),
                                     as.numeric(map.acc$ln.s),
                                     map.acc$ln.cr)))
#Taking out "Es-" part from future labels
map.acc$code <- sub('Es-', '', map.acc$code)
#creating data.frame for colors to correspond to ranking of accessions
colors <- data.frame(accession = as.numeric(row.names(MFV_Ranked)),
                     mean_MFV = MFV_Ranked$Mean,
                     category = as.factor(MFV_Ranked$Category))
#Renaming the categories, so that legend is shown in order of salt tolerance increase, not in alphabetical order
colors$category <- sub('Sensitive', '1. Sensitive', colors$category)
colors$category <- sub('Moderately tolerant', '2. Moderately tolerant', colors$category)
colors$category <- sub('Tolerant', '3. Tolerant', colors$category)


colors <- colors[order(colors[,1]),] #ordering the categories according to accessions numbers

#Creating a map
ggplot(map.acc, aes(x = Longitude, 
                    y = Latitude, 
                    color = as.character(colors$category))) +
  scale_color_manual(values=c("#FF3333", "#009966", "#3366CC"))+
  labs(colour = "Salt tolerance ranks") +
  geom_point() +
  geom_text(aes(label = code), nudge_x = -0.4, size = 3, check_overlap = T) +
  borders(database = "world", regions = "Pakistan") +
  ggtitle("Accessions locations in Pakistan") +
  theme_minimal()
```
#### 8.2 Correlation analysis of elevation and mean MFV
Correlation coefficient (-0,07) showed no link between elevation and salt tolerance (p = 0,75).
```{r}
###--Correlation between ranking and elevation--###
  
#Checking the correlation between mean MFV (of 6 important traits) and elevation
Elev_Cor <- as.data.frame(MFV$Mean)
Elev_Cor$Elevation <- Acc_loc$Elevation
#printing the correlation results  
cor_1 <- rcorr(as.matrix(Elev_Cor))
ell_MFV_cor <- data.frame("Correlation coefficient" = round(cor_1$r[2,1], 2),
                          "P value" = round(cor_1$P[2,1], 2))

knitr::kable(ell_MFV_cor, caption = "Table 8.1 Elevation and MFV mean correlation analysis results", align="c", digits = round(2))
```


## Discussion
### 1. Effects of salt stress on morpho-physiological traits of *E. sativa* accessions.
For the most of morpho-physiological traits salt stress caused significant differentiation of parameters.
Traits that were reduced in salt stressed plants:
i. Morphological (shoot length, root length, plant height, leaf number, leaf area)
ii. Biomass (Fresh weight, Dry weight)
iii. 



1. Explore the effects of salt stress on various morpho-physiological traits in different *E. sativa* accessions. 
2. Identify traits the salt stress has the biggest influence on.
3. Define tolerant and sensitive accessions.
4. Compare our results with the ones from the paper.
5. Explore if location can be linked to salt-tolerance.

Main hypothesis:

- We expect to observe statistically significant differences in morpho-physiological traits between control and salt-treated plants.
- Salt-tolerant and salt-susceptible accessions will belong to different groups based on how much salt stress affects morpho-physiological parameters.
- Geographical location and/or elevation may impact adaptation to salinity. 

(From your objectives)
The preliminary results, despite being slightly different from that in the article produced the ranking that corresponds to the groups (Tolerant - Sensitive) outlined in the article. 








## Conclusions











